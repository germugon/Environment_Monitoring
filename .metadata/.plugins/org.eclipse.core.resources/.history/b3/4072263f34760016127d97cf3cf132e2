package kafka;

import java.util.Properties;

import kafka.javaapi.producer.Producer;
import kafka.producer.KeyedMessage;
import kafka.producer.ProducerConfig;

public class ProducerTest {
	
	private String topic = null;  
	private Producer<String, String> producer = null;  
	
	public ProducerTest( String topic ) {  
		this.topic = topic;
		
		Properties props = new Properties();  
		props.setProperty("metadata.broker.list","192.168.10.100:9092");  
		props.setProperty("serializer.class","kafka.serializer.StringEncoder");  
		props.put("request.required.acks","1");   
		
		ProducerConfig config = new ProducerConfig(props);  
		producer = new Producer<String, String>(config);   
	}
	
	public void sendMessage( String message ) {  
		KeyedMessage<String, String> data = new KeyedMessage<String, String>( topic, message );
		
		try {  
			producer.send(data);  
			System.out.println( "Send message: " + message );  
		} catch (Exception e) {  
			e.printStackTrace();  
		}  
		producer.close();
	}
	
	public static void main(String[] args) {  
		ProducerTest producer = new ProducerTest("mykafka");
		producer.sendMessage("test-kafka-producer");
		   
	}  
	
	
}
